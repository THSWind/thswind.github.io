<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  
  <title>Tensorflow-keras notes | Hexo</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="description" content="我们应该学会站在前辈们的肩膀上，目前已经有人利用 keras实现了常用的深度学习模型 LeNet， AlexNet， ZFNet， VGGNet， GoogleNet，Resnet。推荐一篇博文如下： https:&#x2F;&#x2F;blog.csdn.net&#x2F;wang1127248268&#x2F;article&#x2F;details&#x2F;77258055 1 keras介绍与安装 官网 https:&#x2F;&#x2F;keras.io  安装">
<meta property="og:type" content="article">
<meta property="og:title" content="Tensorflow-keras notes">
<meta property="og:url" content="http://yoursite.com/2019/11/05/Tensorflow-keras%20notes/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:description" content="我们应该学会站在前辈们的肩膀上，目前已经有人利用 keras实现了常用的深度学习模型 LeNet， AlexNet， ZFNet， VGGNet， GoogleNet，Resnet。推荐一篇博文如下： https:&#x2F;&#x2F;blog.csdn.net&#x2F;wang1127248268&#x2F;article&#x2F;details&#x2F;77258055 1 keras介绍与安装 官网 https:&#x2F;&#x2F;keras.io  安装">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2019-11-05T04:59:59.000Z">
<meta property="article:modified_time" content="2020-03-17T16:04:33.671Z">
<meta property="article:author" content="John Doe">
<meta property="article:tag" content="Tensorflow">
<meta name="twitter:card" content="summary">
  
    <link rel="alternate" href="/atom.xml" title="Hexo" type="application/atom+xml">
  
  
    <link rel="shortcut icon" href="/favicon.png">
  
  
    
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/typeface-source-code-pro@0.0.71/index.min.css">

  
  
<link rel="stylesheet" href="/css/style.css">

  
    
<link rel="stylesheet" href="/fancybox/jquery.fancybox.min.css">

  
  
<meta name="generator" content="Hexo 6.1.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Hexo</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"><span class="fa fa-bars"></span></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
        
          <a class="nav-icon" href="/atom.xml" title="RSS Feed"><span class="fa fa-rss"></span></a>
        
        <a class="nav-icon nav-search-btn" title="Search"><span class="fa fa-search"></span></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://yoursite.com"></form>
      </div>
    </div>
  </div>
</header>

      <div class="outer">
        <section id="main"><article id="post-Tensorflow-keras notes" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2019/11/05/Tensorflow-keras%20notes/" class="article-date">
  <time class="dt-published" datetime="2019-11-05T04:59:59.000Z" itemprop="datePublished">2019-11-05</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="p-name article-title" itemprop="headline name">
      Tensorflow-keras notes
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>我们应该学会站在前辈们的肩膀上，目前已经有人利用 keras实现了常用的深度学习模型 LeNet， AlexNet， ZFNet， VGGNet， GoogleNet，Resnet。推荐一篇博文如下：</p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/wang1127248268/article/details/77258055">https://blog.csdn.net/wang1127248268/article/details/77258055</a></p>
<h1 id="1-keras介绍与安装"><a href="#1-keras介绍与安装" class="headerlink" title="1 keras介绍与安装"></a>1 keras介绍与安装</h1><ul>
<li><p>官网</p>
<p><a target="_blank" rel="noopener" href="https://keras.io/">https://keras.io</a></p>
</li>
<li><p>安装</p>
<p><code>pip install keras</code></p>
<p>如果提示需要升级，则输入</p>
<p><code>python -m pip install --upgrade pip</code></p>
<p>可通过 python-&gt; import keras 检测是否安装成功。</p>
</li>
</ul>
<h1 id="2-keras实现线性回归"><a href="#2-keras实现线性回归" class="headerlink" title="2 keras实现线性回归"></a>2 keras实现线性回归</h1><p>`# -*- coding: utf-8 -*-&#96;</p>
<p><code>&quot;&quot;&quot;</code></p>
<p><code>Created on Tue Nov  5 14:27:20 2019</code></p>
<p><code>@author: THSWind</code></p>
<p><code>&quot;&quot;&quot;</code></p>
<p><code>import keras</code> </p>
<p><code>import numpy as np</code></p>
<p><code>import matplotlib.pyplot as plt</code></p>
<p><code>\#按顺序构成的模型</code></p>
<p><code>from keras.models import Sequential</code></p>
<p><code>\#Dense全连接层</code></p>
<p><code>from keras.layers import Dense</code></p>
<p><code>\#使用numpy生成100个随机点</code></p>
<p><code>x_data=np.random.rand(100)</code></p>
<p><code>noise=np.random.normal(0,0.01,x_data.shape)</code></p>
<p><code>y_data=x_data*0.1+0.2+noise</code></p>
<p><code>\#显示随机点</code></p>
<p><code>plt.scatter(x_data,y_data)</code></p>
<p><code>plt.show()</code></p>
<p><code>\#构建一个顺序模型</code></p>
<p><code>model=Sequential()</code></p>
<p><code>\#在模型中添加一个全连接层</code></p>
<p><code>model.add(Dense(units=1,input_dim=1))</code></p>
<p><code>model.compile(optimizer=&#39;sgd&#39;,loss=&#39;mse&#39;)</code></p>
<p><code>\#训练模型</code></p>
<p><code>for step in range(3001):</code></p>
<p>​    <code>\#每次训练一个批次</code></p>
<p>​    <code>cost = model.train_on_batch(x_data,y_data)</code></p>
<p>​    <code>\#每500个batch打印一次cost值</code></p>
<p>​    <code>if step % 500 == 0:</code></p>
<p>​        <code>print(&#39;cost&#39;,cost)</code></p>
<p><code>\#打印权值和偏置值</code></p>
<p><code>W,b=model.layers[0].get_weights()</code></p>
<p><code>print(&#39;W:&#39;,W, &#39;b&#39;,b)</code></p>
<p><code>\#x_data输入网络中，得到预测值y_pred</code></p>
<p><code>y_pred = model.predict(x_data)</code></p>
<p><code>\#显示随机点</code></p>
<p><code>plt.scatter(x_data,y_data)</code></p>
<p><code>\#显示预测结果</code></p>
<p><code>plt.plot(x_data,y_pred,&#39;r-&#39;,lw=3)  #lw表示线条宽度</code></p>
<p><code>plt.show()</code></p>
<h1 id="3-keras非线性回归"><a href="#3-keras非线性回归" class="headerlink" title="3 keras非线性回归"></a>3 keras非线性回归</h1><p>`# -*- coding:utf-8 -*-&#96; </p>
<p><code>&#39;&#39;&#39;</code></p>
<p> <code>\* @Author: THSWind</code> </p>
<p> <code>\* @Date: 2019-11-05 15:39:27</code> </p>
<p> <code>&#39;&#39;&#39;</code></p>
<p><code>import keras</code> </p>
<p><code>import numpy as np</code></p>
<p><code>import matplotlib.pyplot as plt</code></p>
<p><code>\#按顺序构成的模型</code></p>
<p><code>from keras.models import Sequential</code></p>
<p><code>\#Dense全连接层</code></p>
<p><code>from keras.layers import Dense,Activation</code></p>
<p><code>from keras.optimizers import SGD</code></p>
<p><code>\#</code></p>
<p><code>x_data = np.linspace(-0.5,0.5,200)</code></p>
<p><code>noise = np.random.normal(0,0.02,x_data.shape)</code></p>
<p><code>y_data = np.square(x_data) + noise</code></p>
<p><code>\# 显示随机点</code></p>
<p><code>plt.scatter(x_data,y_data)</code></p>
<p><code>plt.show()</code></p>
<p><code>\#构建一个顺序模型</code></p>
<p><code>model=Sequential()</code></p>
<p><code>\#在模型中添加一个全连接层</code></p>
<p><code>\# 1-10-1</code></p>
<p><code>\#定义优化算法</code></p>
<p><code>sgd = SGD(lr=0.3)    # 由于默认的sgd学习率较小，所以导入SGD，自定义学习率加快学习时间</code></p>
<p><code>\# 不添加激活函数，则拟合的曲线仍然可能是直线。因为默认的激活函数是一条直线f(x)=x</code></p>
<p><code>model.add(Dense(units=10,input_dim=1))</code></p>
<p><code>model.add(Activation(&#39;tanh&#39;))</code></p>
<p><code>model.add(Dense(units=1))</code></p>
<p><code>model.add(Activation(&#39;tanh&#39;))</code></p>
<p><code>model.compile(optimizer=sgd,loss=&#39;mse&#39;)</code></p>
<p><code>\# tanh 在大多数情况下比 sigmoid好用 ————吴恩达</code></p>
<p><code>\#训练模型</code></p>
<p><code>for step in range(3001):</code></p>
<p>​    <code>\#每次训练一个批次</code></p>
<p>​    <code>cost = model.train_on_batch(x_data,y_data)</code></p>
<p>​    <code>\#每500个batch打印一次cost值</code></p>
<p>​    <code>if step % 500 == 0:</code></p>
<p>​        <code>print(&#39;cost&#39;,cost)</code></p>
<p><code>\#打印权值和偏置值</code></p>
<p><code>W,b=model.layers[0].get_weights()</code></p>
<p><code>print(&#39;W:&#39;,W, &#39;b&#39;,b)</code></p>
<p><code>\#x_data输入网络中，得到预测值y_pred</code></p>
<p><code>y_pred = model.predict(x_data)</code></p>
<p><code>\#显示随机点</code></p>
<p><code>plt.scatter(x_data,y_data)</code></p>
<p><code>\#显示预测结果</code></p>
<p><code>plt.plot(x_data,y_pred,&#39;r-&#39;,lw=3)  #lw表示线条宽度</code></p>
<p><code>plt.show()</code></p>
<h1 id="4-MNIST分类程序"><a href="#4-MNIST分类程序" class="headerlink" title="4 MNIST分类程序"></a>4 MNIST分类程序</h1><p>`# -*- coding:utf-8 -*-&#96; </p>
<p><code>&#39;&#39;&#39;</code></p>
<p> <code>\* @Author: THSWind</code> </p>
<p> <code>\* @Date: 2019-11-05 16:09:06</code> </p>
<p> <code>&#39;&#39;&#39;</code></p>
<p><code>import numpy as np</code> </p>
<p><code>from keras.datasets import mnist</code></p>
<p><code>from keras.utils import np_utils</code></p>
<p><code>from keras.models import Sequential</code></p>
<p><code>from keras.layers import Dense</code></p>
<p><code>from keras.optimizers import SGD</code></p>
<p><code>\# 载入数据</code></p>
<p><code>(x_train,y_train),(x_test,y_test)= mnist.load_data()</code></p>
<p><code>\# (60000,28,28)</code></p>
<p><code>print(&#39;x_shape: &#39;,x_train.shape)</code></p>
<p><code>\#(60000)</code></p>
<p><code>print(&#39;y_shape: &#39;, y_train.shape)</code></p>
<p><code>\#(60000,28,28)-&gt;(60000,784)</code></p>
<p><code>x_train=x_train.reshape(x_train.shape[0], -1)/255.0</code></p>
<p><code>x_test=x_test.reshape(x_test.shape[0], -1)/255.0</code></p>
<p><code>\# 转化label为 one-hot格式</code></p>
<p><code>y_train=np_utils.to_categorical(y_train, num_classes=10)</code></p>
<p><code>y_test=np_utils.to_categorical(y_test, num_classes=10)</code></p>
<p><code>\# 创建模型 输入784个神经元，输出10个神经元</code></p>
<p><code>model = Sequential([</code></p>
<p>​    <code>Dense(units=10, input_dim=784, bias_initializer=&#39;one&#39;,activation=&#39;softmax&#39;)</code></p>
<p><code>])</code></p>
<p><code>\# 定义优化器</code></p>
<p><code>sgd = SGD(lr=0.2)</code></p>
<p><code>\# 定义优化器， loss function,训练过程中计算准确率</code></p>
<p><code>model.compile(</code></p>
<p>​    <code>optimizer=sgd,</code></p>
<p>​    <code>loss=&#39;mse&#39;,</code></p>
<p>​    <code>metrics=[&#39;accuracy&#39;],</code></p>
<p><code>)</code></p>
<p><code>\# 训练模型</code></p>
<p><code>model.fit(x_train,y_train,batch_size=32,epochs=10)</code></p>
<p><code>\# 评估模型</code></p>
<p><code>loss,accuracy=model.evaluate(x_test,y_test)</code></p>
<p><code>print(&#39;\ntest loss&#39;,loss)</code></p>
<p><code>print(&#39;accuracy&#39;, accuracy)</code></p>
<h1 id="5-交叉熵应用"><a href="#5-交叉熵应用" class="headerlink" title="5 交叉熵应用"></a>5 交叉熵应用</h1><p><code>model.compile(</code></p>
<p>​    <code>optimizer=sgd,</code></p>
<p>​    <code>loss=&#39;categorical_crossentropy&#39;,  # 改为交叉熵</code></p>
<p>​    <code>metrics=[&#39;accuracy&#39;],</code></p>
<p><code>)</code></p>
<h1 id="6-Dropout"><a href="#6-Dropout" class="headerlink" title="6 Dropout"></a>6 Dropout</h1><p><code>from keras.layers import Dense,Dropout</code></p>
<p><code>.......</code></p>
<p>#drop(0.4) 表示让40%的神经元不工作</p>
<p><code>model = Sequential([</code></p>
<p>​    <code>Dense(units=200, input_dim=784, bias_initializer=&#39;one&#39;,activation=&#39;tanh&#39;),</code></p>
<p>​    <code>Dropout(0.4),</code></p>
<p>​    <code>Dense(units=200,  bias_initializer=&#39;one&#39;,activation=&#39;tanh&#39;),</code></p>
<p>​    <code>Dropout(0.4),</code></p>
<p>​    <code>Dense(units=10,  bias_initializer=&#39;one&#39;,activation=&#39;softmax&#39;),</code></p>
<p><code>])</code></p>
<h1 id="7-正则化"><a href="#7-正则化" class="headerlink" title="7 正则化"></a>7 正则化</h1><p><code>from keras.regularizers import l2</code></p>
<p><code>.......</code></p>
<p><code>model = Sequential([</code></p>
<p>​    <code>Dense(units=200, input_dim=784, bias_initializer=&#39;one&#39;,activation=&#39;tanh&#39;,kernel_regularizer=l2(0.0003)),</code></p>
<p>​    <code>Dense(units=200,  bias_initializer=&#39;one&#39;,activation=&#39;tanh&#39;,kernel_regularizer=l2(0.0003)),</code></p>
<p>​    <code>Dense(units=10,  bias_initializer=&#39;one&#39;,activation=&#39;softmax&#39;,kernel_regularizer=l2(0.0003)),</code></p>
<p><code>])</code></p>
<h1 id="8-CNN手写识别"><a href="#8-CNN手写识别" class="headerlink" title="8 CNN手写识别"></a>8 CNN手写识别</h1><p>`# -*- coding:utf-8 -*-&#96; </p>
<p><code>&#39;&#39;&#39;</code></p>
<p> <code>\* @Author: THSWind</code> </p>
<p> <code>\* @Date: 2019-11-05 17:53:34</code> </p>
<p> <code>&#39;&#39;&#39;</code></p>
<p><code>import numpy as np</code> </p>
<p><code>from keras.datasets import mnist</code></p>
<p><code>from keras.utils import np_utils</code></p>
<p><code>from keras.models import Sequential</code></p>
<p><code>from keras.layers import Dense,Dropout,Convolution2D,MaxPooling2D,Flatten</code></p>
<p><code>from keras.optimizers import Adam</code></p>
<p><code>\# 载入数据</code></p>
<p><code>(x_train,y_train),(x_test,y_test)= mnist.load_data()</code></p>
<p><code>\# (60000,28,28)</code></p>
<p><code>\#(60000,28,28)-&gt;(60000,28,28,1)   1是图片的深度，灰度模式</code></p>
<p><code>x_train=x_train.reshape(-1,28,28,1)/255.0</code></p>
<p><code>x_test=x_test.reshape(-1,28,28,1)/255.0</code></p>
<p><code>\# 转化label为 one-hot格式</code></p>
<p><code>y_train=np_utils.to_categorical(y_train, num_classes=10)</code></p>
<p><code>y_test=np_utils.to_categorical(y_test, num_classes=10)</code></p>
<p><code>\# 定义顺序模型</code></p>
<p><code>model = Sequential()</code></p>
<p><code>\#第一个卷积层</code></p>
<p><code>\# input_shape 输入平面</code></p>
<p><code>\# filters 卷积核/滤波器个数</code></p>
<p><code>\# kernel_size 卷积窗口大小</code></p>
<p><code>\# strides 步长</code></p>
<p><code>\# padding padding方式  same/valid</code></p>
<p><code>\# activation 激活函数</code></p>
<p><code>model.add(Convolution2D(</code></p>
<p>​    <code>input_shape = (28,28,1),</code></p>
<p>​    <code>filters=32,</code></p>
<p>​    <code>kernel_size=5,</code></p>
<p>​    <code>strides=1,</code></p>
<p>​    <code>padding=&#39;same&#39;,</code></p>
<p>​    <code>activation=&#39;relu&#39;</code></p>
<p><code>))</code></p>
<p><code>\#第一个池化层</code></p>
<p><code>model.add(MaxPooling2D(</code></p>
<p>​    <code>pool_size=2,</code></p>
<p>​    <code>strides=2,</code></p>
<p>​    <code>padding=&#39;same&#39;,</code></p>
<p><code>))</code></p>
<p><code>\#第二个卷积层</code></p>
<p><code>model.add(Convolution2D(</code></p>
<p>​    <code>64,</code></p>
<p>​    <code>5,</code></p>
<p>​    <code>strides=1,</code></p>
<p>​    <code>padding=&#39;same&#39;,</code></p>
<p>​    <code>activation=&#39;relu&#39;</code></p>
<p><code>))</code></p>
<p><code>\#第二个池化层</code></p>
<p><code>model.add(MaxPooling2D(2,2,&#39;same&#39;,))</code></p>
<p><code>\#把第二个池化层的输出扁平化为1维</code></p>
<p><code>model.add(Flatten())</code></p>
<p><code>\#第一个全连接层</code></p>
<p><code>model.add(Dense(1024,activation=&#39;relu&#39;))</code></p>
<p><code>\# dropout</code></p>
<p><code>model.add(Dropout(0.5))</code></p>
<p><code>\#第二个全连接层</code></p>
<p><code>model.add(Dense(10,activation=&#39;softmax&#39;))</code></p>
<p><code>\#定义优化器</code></p>
<p><code>adam=Adam(lr=1e-4)</code></p>
<p><code>\#定义优化器，loss function， 训练过程中计算准确率</code></p>
<p><code>model.compile(optimizer=adam,loss=&#39;categorical_crossentropy&#39;,metrics=[&#39;accuracy&#39;])</code></p>
<p><code>\#训练模型</code></p>
<p><code>model.fit(x_train,y_train,batch_size=64,epochs=10)</code></p>
<p><code>\#评估模型</code></p>
<p><code>loss,accuracy=model.evaluate(x_test,y_test)</code></p>
<p><code>print(&#39;test loss&#39;,loss)</code></p>
<p><code>print(&#39;test accuracy&#39;, accuracy)</code></p>
<h1 id="9-RNN应用"><a href="#9-RNN应用" class="headerlink" title="9 RNN应用"></a>9 RNN应用</h1><p>RNN用于手写数字识别（结果表明，还是卷积神经网络适合一点，RNN不适用于手写数字识别，准确率没卷积神经网络高。）</p>
<p>`# -*- coding:utf-8 -*-&#96; </p>
<p><code>&#39;&#39;&#39;</code></p>
<p> <code>\* @Author: THSWind</code> </p>
<p> <code>\* @Date: 2019-11-05 18:40:33</code> </p>
<p> <code>&#39;&#39;&#39;</code></p>
<p><code>import numpy as np</code> </p>
<p><code>from keras.datasets import mnist</code></p>
<p><code>from keras.utils import np_utils</code></p>
<p><code>from keras.models import Sequential</code></p>
<p><code>from keras.layers import Dense</code></p>
<p><code>from keras.layers.recurrent import SimpleRNN</code></p>
<p><code>from keras.optimizers import Adam</code></p>
<p><code>\# 数据长度 一行有28个像素</code></p>
<p><code>input_size = 28</code></p>
<p><code>\# 序列长度 一共有28行</code></p>
<p><code>time_steps = 28</code></p>
<p><code>\# 隐藏层 cell 个数</code></p>
<p><code>cell_size = 50</code></p>
<p><code>\# 载入数据</code></p>
<p><code>(x_train, y_train), (x_test, y_test) = mnist.load_data()</code></p>
<p><code>\#(60000,28,28)</code></p>
<p><code>x_train=x_train/255.0</code></p>
<p><code>x_test=x_test/255.0</code></p>
<p><code>\# 换 one hot格式</code></p>
<p><code>y_train = np_utils.to_categorical(y_train, num_classes=10)</code></p>
<p><code>y_test = np_utils.to_categorical(y_test, num_classes=10)</code></p>
<p><code>\# 创建模型</code></p>
<p><code>model= Sequential()</code></p>
<p><code>\# 循环神经网络</code></p>
<p><code>model.add(SimpleRNN(</code></p>
<p>​    <code>units=cell_size, # 输出</code></p>
<p>​    <code>input_shape = (time_steps, input_size), # 输入</code></p>
<p><code>))</code></p>
<p><code>\# 输出层</code></p>
<p><code>model.add(Dense(10, activation=&#39;softmax&#39;))</code></p>
<p><code>\# 定义优化器</code></p>
<p><code>adam = Adam(lr=1e-4)</code></p>
<p><code>\# 定义优化器，loss function， 训练过程中计算准确率</code></p>
<p><code>model.compile(optimizer=adam, loss=&#39;categorical_crossentropy&#39;,metrics=[&#39;accuracy&#39;])</code></p>
<p><code>\# 训练模型</code></p>
<p><code>model.fit(x_train,y_train,batch_size=64,epochs=10)</code></p>
<p><code>\#评估模型</code></p>
<p><code>loss, accuracy= model.evaluate(x_test, y_test)</code></p>
<p><code>print(&#39;test loss&#39;, loss)</code></p>
<p><code>print(&#39;test accuracy&#39;, accuracy)</code></p>
<h1 id="10-keras-模型的保存与载入"><a href="#10-keras-模型的保存与载入" class="headerlink" title="10 keras 模型的保存与载入"></a>10 keras 模型的保存与载入</h1><h2 id="保存"><a href="#保存" class="headerlink" title="保存"></a>保存</h2><ul>
<li><p>保存模型以及参数</p>
<p><code>model.save(&#39;model.h5&#39;)   # HDF5文件， pip install h5py</code></p>
</li>
<li><p>只保存参数，与载入参数</p>
<p><code>model.save_weights(&#39;my_model_weights.h5&#39;)</code></p>
<p><code>model.load_weights(&#39;my_model_weights.h5&#39;)</code></p>
</li>
<li><p>保存网络结构，与载入网络结构</p>
<p><code>from keras.models import model_from_json</code></p>
<p><code>......</code></p>
<p><code>json_string = model.to_json()</code></p>
<p><code>model = model_from_json(json_string)</code></p>
</li>
</ul>
<h2 id="载入"><a href="#载入" class="headerlink" title="载入"></a>载入</h2><p><code>from keras.models import load_model</code></p>
<p><code>......</code></p>
<p><code>#载入模型</code></p>
<p><code>model = load_model(&#39;model.h5&#39;)</code></p>
<p><code>#评估模型</code></p>
<p><code>loss, accurach = model.evaluate(x_test, y_test)</code></p>
<p><code>print(&#39;\ntest loss&#39;, loss)</code></p>
<p><code>print(&#39;accuracy&#39;, accuracy)</code></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2019/11/05/Tensorflow-keras%20notes/" data-id="cmd4qfdor001vh0j0dq764vfe" data-title="Tensorflow-keras notes" class="article-share-link"><span class="fa fa-share">Share</span></a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Tensorflow/" rel="tag">Tensorflow</a></li></ul>

    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2019/11/05/Browser%20related%20issues/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          Browser-related problems and solutions
        
      </div>
    </a>
  
  
    <a href="/2019/11/05/tensorflow2.0%20notes/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">tensorflow2.0 notes</div>
    </a>
  
</nav>

  
</article>


</section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Categories</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/reading/">reading</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/ALG/" rel="tag">ALG</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Anaconda/" rel="tag">Anaconda</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/DL/" rel="tag">DL</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Linux/" rel="tag">Linux</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Python/" rel="tag">Python</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/RL/" rel="tag">RL</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Software-Testing/" rel="tag">Software Testing</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Tensorflow/" rel="tag">Tensorflow</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Vscode/" rel="tag">Vscode</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/browser/" rel="tag">browser</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/encryption/" rel="tag">encryption</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/latex/" rel="tag">latex</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/network-security/" rel="tag">network_security</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/pc/" rel="tag">pc</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/server/" rel="tag">server</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/tips/" rel="tag">tips</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/website/" rel="tag">website</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/ALG/" style="font-size: 12.5px;">ALG</a> <a href="/tags/Anaconda/" style="font-size: 10px;">Anaconda</a> <a href="/tags/DL/" style="font-size: 10px;">DL</a> <a href="/tags/Linux/" style="font-size: 17.5px;">Linux</a> <a href="/tags/Python/" style="font-size: 17.5px;">Python</a> <a href="/tags/RL/" style="font-size: 20px;">RL</a> <a href="/tags/Software-Testing/" style="font-size: 10px;">Software Testing</a> <a href="/tags/Tensorflow/" style="font-size: 15px;">Tensorflow</a> <a href="/tags/Vscode/" style="font-size: 10px;">Vscode</a> <a href="/tags/browser/" style="font-size: 10px;">browser</a> <a href="/tags/encryption/" style="font-size: 10px;">encryption</a> <a href="/tags/latex/" style="font-size: 10px;">latex</a> <a href="/tags/network-security/" style="font-size: 10px;">network_security</a> <a href="/tags/pc/" style="font-size: 12.5px;">pc</a> <a href="/tags/server/" style="font-size: 12.5px;">server</a> <a href="/tags/tips/" style="font-size: 12.5px;">tips</a> <a href="/tags/website/" style="font-size: 15px;">website</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/02/">February 2024</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/07/">July 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/07/">July 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/06/">June 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/03/">March 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/01/">January 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/12/">December 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/11/">November 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/10/">October 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/09/">September 2019</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2024/02/05/encrypt-test/">(no title)</a>
          </li>
        
          <li>
            <a href="/2021/07/31/The-Art-of-Software-Testing/">The Art of Software Testing</a>
          </li>
        
          <li>
            <a href="/2020/07/31/Data-Processing/">Data Processing</a>
          </li>
        
          <li>
            <a href="/2020/07/31/Something-about-Tensorflow/">Something about Tensorflow</a>
          </li>
        
          <li>
            <a href="/2020/07/31/MultiProcessing-in-Python/">MultiProcessing in Python</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      
      &copy; 2025 John Doe<br>
      Powered by <a href="https://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>

    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    


<script src="/js/jquery-3.6.4.min.js"></script>



  
<script src="/fancybox/jquery.fancybox.min.js"></script>




<script src="/js/script.js"></script>





  </div>
<script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"log":false,"pluginJsPath":"lib/","pluginModelPath":"assets/","pluginRootPath":"live2dw/","tagMode":false});</script></body>
</html>